---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "Resource pfptmeta_url_filtering_rule - terraform-provider-pfptmeta"
subcategory: "Web Security Resources"
description: |-
  The Proofpoint Web Security solution protects against web-based security threats by defining URL filtering rules
  which include various content and threat categories, as well as cloud-based applications and tenant restrictions.
  With these measures, you can enforce company security policies and filter malicious internet traffic in real time.
---

# Resource (pfptmeta_url_filtering_rule)

The Proofpoint Web Security solution protects against web-based security threats by defining URL filtering rules
which include various content and threat categories, as well as cloud-based applications and tenant restrictions.
With these measures, you can enforce company security policies and filter malicious internet traffic in real time.

## Example Usage

### Default Rule:

```terraform
resource "pfptmeta_threat_category" "malicious" {
  name             = "Malicious Threat"
  confidence_level = "LOW"
  risk_level       = "LOW"
  countries        = ["IR", "KP"]
  types = [
    "Bitcoin Related", "Blackhole", "Botnets", "Brute Forcer", "CnC", "Compromised", "Drop", "EXE Source",
    "Fake AV", "Keyloggers and Monitoring", "Malware Sites", "Mobile CnC", "Mobile Spyware CnC", "P2P CnC",
    "Phishing and Other Frauds", "Spyware and Adware", "Tor"
  ]
}

resource "pfptmeta_content_category" "strict" {
  name             = "Strict Category"
  confidence_level = "LOW"
  types = [
    "Sex Education", "Nudity", "Abused Drugs", "Marijuana", "Swimsuits and Intimate Apparel", "Violence",
    "Gross", "Adult and Pornography", "Weapons", "Hate and Racism", "Gambling"
  ]
  urls = ["espn.com"]
}

resource "pfptmeta_url_filtering_rule" "default_rule" {
  name                         = "default rule"
  description                  = "default rule"
  apply_to_org                 = true
  action                       = "BLOCK"
  advanced_threat_protection   = true
  threat_categories            = [pfptmeta_threat_category.malicious.id]
  forbidden_content_categories = [pfptmeta_content_category.strict.id]
  priority                     = 94
  warn_ttl                     = 15
}
```

### High Risk:

```terraform
data "pfptmeta_catalog_app" "salesforce" {
  name     = "Salesforce"
  category = "Business and Finance"
}

resource "pfptmeta_cloud_app" "salesforce" {
  name = "salesforce"
  app  = data.pfptmeta_catalog_app.salesforce.id
  urls = ["my.salesforce.com"]
}

resource "pfptmeta_url_filtering_rule" "high_risk" {
  name              = "Block High Risk - Expression"
  apply_to_org      = true
  action            = "BLOCK"
  cloud_apps        = [pfptmeta_cloud_app.salesforce.id]
  filter_expression = "crwd_agent:fail OR crwdzta:high OR npre-it"
  priority          = 90
  warn_ttl          = 15
}
```

### Log All:

```terraform
resource "pfptmeta_threat_category" "log_all" {
  name             = "Threats To Log"
  confidence_level = "LOW"
  risk_level       = "LOW"
  types = [
    "Botnets", "Chat Server", "Phishing and Other Frauds", "Utility", "Self Signed SSL", "Brute Forcer", "DDoS Target",
    "Parking", "Scanner", "Online Gaming", "Blackhole", "Compromised", "Fake AV", "Malware Sites", "P2P CnC",
    "Remote Access Service", "Bitcoin Related", "SPAM URLs", "Mobile CnC", "Tor", "IP Check", "DynDNS", "CnC",
    "Spyware and Adware", "Undesirable", "Mobile Spyware CnC", "Abused TLD", "EXE Source", "VPN", "Drop",
    "Proxy Avoidance and Anonymizers", "Peer to Peer"
  ]
}

resource "pfptmeta_content_category" "log_all" {
  name             = "Category To Log"
  confidence_level = "HIGH"
  types = [
    "Abortion", "Sex Education", "Pay to Surf", "Web Advertisements", "Dynamically Generated Content",
    "Parked Domains", "Alcohol and Tobacco", "Personal sites and Blogs", "Hacking",
    "Abused Drugs", "Marijuana", "Training and Tools", "Reference and Research", "Educational Institutions",
    "Web-based Email", "Financial Services", "Business and Economy",
    "Individual Stock Advice and Tools", "Home and Garden", "Gambling", "Games", "Kids", "Legal", "Government",
    "Health and Medicine", "Recreation and Hobbies", "Questionable", "Cheating", "Illegal", "Job Search",
    "Swimsuits and Intimate Apparel", "Hate and Racism", "Local Information", "News and Media", "Nudity",
    "Philosophy and Political Advocacy", "Adult and Pornography", "Internet Portals", "Real Estate", "Cult and Occult",
    "Religion", "Search Engines", "Image and Video Search", "Auctions", "Shopping", "Online Greeting Cards",
    "Fashion and Beauty", "Social Networking", "Dating", "Society", "Computer and Internet Security",
    "Computer and Internet Info", "Shareware and Freeware", "Personal Storage", "Content Delivery Networks",
    "Web Hosting", "Internet Communications", "Hunting and Fishing", "Sports", "Streaming Media",
    "Entertainment and Arts", "Translation", "Travel", "Motor Vehicles", "Violence", "Gross", "Weapons"
  ]
  urls = ["clarivate.io"]
}

resource "pfptmeta_url_filtering_rule" "log_all" {
  name                         = "Log All"
  apply_to_org                 = true
  action                       = "LOG"
  advanced_threat_protection   = true
  threat_categories            = [pfptmeta_threat_category.log_all.id]
  forbidden_content_categories = [pfptmeta_content_category.log_all.id]
  priority                     = 95
  warn_ttl                     = 15
}
```

### Isolate Web Mails:

```terraform
resource "pfptmeta_content_category" "web_mail_category" {
  name             = "Webmail Category"
  confidence_level = "LOW"
  types            = ["Web-based Email"]
  urls             = ["live.com", "outlook.com"]
}

resource "pfptmeta_url_filtering_rule" "isolate_web_mails" {
  name                         = "Isolate Web Mails"
  apply_to_org                 = true
  action                       = "ISOLATE"
  advanced_threat_protection   = false
  forbidden_content_categories = [pfptmeta_content_category.web_mail_category.id]
  priority                     = 92
  warn_ttl                     = 15
}
```

### Warn For Dropbox:

```terraform
data "pfptmeta_catalog_app" "dropbox" {
  name     = "Dropbox"
  category = "Collaboration"
}

resource "pfptmeta_cloud_app" "dropbox_personal" {
  name        = "Dropbox Personal"
  app         = data.pfptmeta_catalog_app.dropbox.id
  tenant_type = "Personal"
}

resource "pfptmeta_url_filtering_rule" "warn_for_dropbox" {
  name         = "Warn For Dropbox"
  apply_to_org = true
  action       = "WARN"
  cloud_apps   = [pfptmeta_cloud_app.dropbox_personal.id]
  priority     = 88
  warn_ttl     = 15
}
```

### Block Contents During Work Hours:

```terraform
resource "pfptmeta_content_category" "news" {
  name             = "News"
  confidence_level = "LOW"
  types            = ["News and Media"]
}

resource "pfptmeta_content_category" "social_network" {
  name             = "Social Networking"
  confidence_level = "LOW"
  types            = ["Social Networking"]
}

resource "pfptmeta_time_frame" "work_hours" {
  name = "Work Hours"
  days = ["monday", "tuesday", "wednesday", "thursday", "friday"]
  start_time {
    hour   = 8
    minute = 0
  }
  end_time {
    hour   = 18
    minute = 0
  }
}

resource "pfptmeta_url_filtering_rule" "work_time" {
  name                         = "News And Social Networking"
  description                  = "Blocks news and social networking during work hours"
  apply_to_org                 = true
  action                       = "BLOCK"
  advanced_threat_protection   = false
  forbidden_content_categories = [pfptmeta_content_category.news.id, pfptmeta_content_category.social_network.id]
  priority                     = 80
  warn_ttl                     = 15
  schedule                     = [pfptmeta_time_frame.work_hours.id]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `action` (String) Enum: `ISOLATE`, `BLOCK`, `LOG`, `RESTRICT`, `WARN`.
This action determines what must be done according to this URL filtering rule if a user tries to reach a restricted URL.
- `name` (String)

### Optional

- `advanced_threat_protection` (Boolean) Enables the first-rate security engine based on up-to-date web threat intelligence gathered from two decades of protecting the world's largest organizations from email-borne attacks.
- `apply_to_org` (Boolean) indicates whether this URL filtering rule applies to the org.
- `catalog_app_categories` (List of String) ENUM: `Instant Messaging`, `eCommerce`, `Content Management`, `Software Development`, `Project Management`, `Marketing`, `CRM`, `Telecommunications`, `Social and Communication`, `Productivity`, `Collaboration`, `Business and Finance`, `Utilities`, `IT Service Management`, `Social Networking`, `Office Document and Productivity`, `Cloud File Sharing`, `Web Meetings`, `Identity and Access Management`, `IT Services and Hosting`, `Webmail`, `Website Builder`, `Human Capital Management`, `Sales and CRM`, `E-commerce and Accounting`, `Streaming Media`, `Cloud Storage`, `Operations Management`, `Online Meeting`, `Supply Chain`, `Security and Compliance`, `Entertainment and Lifestyle`, `System and Network`, `Retail and Consumer Services`, `Health and Benefits`, `Data and Analytics`, `Education and References`, `Personal instant messaging`, `Legal`, `Other`, `Hosting Services`, `News and Media`, `Sales`, `Enterprise Resource Planning`, `Advertising`, `Travel and Transportation`, `Property Management`, `Government Services`, `Games`, `Code Hosting`.
List of catalog app categories that the URL filtering rule must restrict.
- `catalog_app_risk` (Number) Risk threshold to be used to restrict all catalog apps which has that risk or higher.
- `cloud_apps` (List of String) List of [cloud app](https://registry.terraform.io/providers/nsofnetworks/pfptmeta/latest/docs/resources/cloud_app) IDs which the URL filtering rule should restrict.
- `countries` (List of String) A list of countries in which this rule should be applied. Each country should be represented by a Alpha-2 code (ISO-3166). Enum: `AD`,`AE`,`AF`,`AG`,`AI`,`AL`,`AM`,`AO`,`AQ`,`AR`,`AS`,`AT`,`AU`,`AW`,`AX`,`AZ`,`BA`,`BB`,`BD`,`BE`,`BF`,`BG`,`BH`,`BI`,`BJ`,`BL`,`BM`,`BN`,`BO`,`BQ`,`BR`,`BS`,`BT`,`BV`,`BW`,`BY`,`BZ`,`CA`,`CC`,`CD`,`CF`,`CG`,`CH`,`CI`,`CK`,`CL`,`CM`,`CN`,`CO`,`CR`,`CU`,`CV`,`CW`,`CX`,`CY`,`CZ`,`DE`,`DJ`,`DK`,`DM`,`DO`,`DZ`,`EC`,`EE`,`EG`,`EH`,`ER`,`ES`,`ET`,`FI`,`FJ`,`FK`,`FM`,`FO`,`FR`,`GA`,`GB`,`GD`,`GE`,`GF`,`GG`,`GH`,`GI`,`GL`,`GM`,`GN`,`GP`,`GQ`,`GR`,`GS`,`GT`,`GU`,`GW`,`GY`,`HK`,`HM`,`HN`,`HR`,`HT`,`HU`,`ID`,`IE`,`IL`,`IM`,`IN`,`IO`,`IQ`,`IR`,`IS`,`IT`,`JE`,`JM`,`JO`,`JP`,`KE`,`KG`,`KH`,`KI`,`KM`,`KN`,`KP`,`KR`,`KW`,`KY`,`KZ`,`LA`,`LB`,`LC`,`LI`,`LK`,`LR`,`LS`,`LT`,`LU`,`LV`,`LY`,`MA`,`MC`,`MD`,`ME`,`MF`,`MG`,`MH`,`MK`,`ML`,`MM`,`MN`,`MO`,`MP`,`MQ`,`MR`,`MS`,`MT`,`MU`,`MV`,`MW`,`MX`,`MY`,`MZ`,`NA`,`NC`,`NE`,`NF`,`NG`,`NI`,`NL`,`NO`,`NP`,`NR`,`NU`,`NZ`,`OM`,`PA`,`PE`,`PF`,`PG`,`PH`,`PK`,`PL`,`PM`,`PN`,`PR`,`PS`,`PT`,`PW`,`PY`,`QA`,`RE`,`RO`,`RS`,`RU`,`RW`,`SA`,`SB`,`SC`,`SD`,`SE`,`SG`,`SH`,`SI`,`SJ`,`SK`,`SL`,`SM`,`SN`,`SO`,`SR`,`SS`,`ST`,`SV`,`SX`,`SY`,`SZ`,`TC`,`TD`,`TF`,`TG`,`TH`,`TJ`,`TK`,`TL`,`TM`,`TN`,`TO`,`TR`,`TT`,`TV`,`TW`,`TZ`,`UA`,`UG`,`UM`,`US`,`UY`,`UZ`,`VA`,`VC`,`VE`,`VG`,`VI`,`VN`,`VU`,`WF`,`WS`,`YE`,`YT`,`ZA`,`ZM`,`ZW`
- `description` (String)
- `enabled` (Boolean)
- `exempt_sources` (List of String) Subgroup of 'sources' on which the URL filtering rule should not be applied.
- `expires_at` (String) Defines the rule expiration time. This can be useful when creating exceptions for users who need them for a limited period of time as an alternative for full disconnection from the proxy. When no value is given the URL filtering rule will never expire. Takes `RFC3339` (`2006-01-02T15:04:05Z`) date format.
- `filter_expression` (String) Defines filtering expressions to ensure granularity in URL filtering rule application.
These expressions consist of the **{Key:Value}** tags according to the internal and external risk factors obtained from the following sources:

	- Proofpoint’s Nexus People Risk Explorer (NPRE).
	- Proofpoint’s Targeted Attack Protection (TAP).
	- CrowdStrike’s Falcon Zero Trust Assessment (ZTA).
	- Configured posture checks.
	- User-defined tags.
	- Auto-generated tags, such as platform type, device type, etc.
- `forbidden_content_categories` (List of String) List of [content category](https://registry.terraform.io/providers/nsofnetworks/pfptmeta/latest/docs/resources/content_category) IDs which the URL filtering rule should restrict.
- `networks` (List of String) List of source [IP network](https://registry.terraform.io/providers/nsofnetworks/pfptmeta/latest/docs/resources/ip_network) IDs the URL filtering rule applies on
- `priority` (Number) Determines the order in which the URL-filtering rules are evaluated. The order is significant since the first URL-filtering rule that finds a URL restricted is the one to determine which action to execute. Lower priority value means the URL-filtering rule will be evaluated earlier.
- `schedule` (List of String) List of [time frame](https://registry.terraform.io/providers/nsofnetworks/pfptmeta/latest/docs/resources/time_frame) IDs during which the URL filtering rule will be enforced
- `sources` (List of String) Users and groups on which the URL filtering rule should be applied.
- `tenant_restriction` (String) [Tenant restrictions](https://registry.terraform.io/providers/nsofnetworks/pfptmeta/latest/docs/resources/tenant_restriction) for this rule. Only the `RESTRICT` action is allowed when this option is set.
- `threat_categories` (List of String) List of [threat category](https://registry.terraform.io/providers/nsofnetworks/pfptmeta/latest/docs/resources/threat_category) IDs the URL filtering rule will protect against
- `warn_ttl` (Number) Time in minutes during which the warning page is not shown again after user proceeds to URL

### Read-Only

- `id` (String) The ID of this resource.
